---
import Layout from '../../../layouts/Layout.astro';
import Nav from '../../../components/Nav.astro';
import { t as translate } from '../../../i18n/utils';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const posts = await getCollection('blog');
  return posts
    .filter(post => post.data.lang === 'es')
    .map(post => ({
      params: { slug: post.slug.replace('es/', '') },
      props: { post },
    }));
}

const { post } = Astro.props;
const { Content } = await post.render();
const lang = 'es';
const tf = (key: string) => translate(lang, key);
---

<Layout
  title={`${post.data.title} — Clic Root`}
  description={post.data.description}
  lang={lang}
>
  <Nav lang={lang} t={tf} />

  <article class="blog-post">
    <div class="container">
      <div class="post-header">
        <a href={`/${lang}/`} class="back-link">← Volver</a>
        <div class="post-emoji">{post.data.emoji}</div>
        <h1>{post.data.title}</h1>
        <p class="post-meta">{post.data.date.toLocaleDateString('es-ES', { month: 'long', day: 'numeric', year: 'numeric' })}</p>
      </div>
      <div class="post-content">
        <Content />
      </div>
    </div>
  </article>
</Layout>

<style>
  .blog-post { padding-top: 120px; padding-bottom: 80px; }
  .post-header { max-width: 680px; margin: 0 auto 48px; text-align: center; }
  .back-link { color: var(--accent); text-decoration: none; font-size: 0.9rem; font-weight: 600; display: inline-block; margin-bottom: 32px; }
  .back-link:hover { text-decoration: underline; }
  .post-emoji { font-size: 3rem; margin-bottom: 20px; }
  .post-header h1 { font-size: clamp(1.8rem, 4vw, 2.8rem); font-weight: 800; line-height: 1.2; letter-spacing: -0.02em; margin-bottom: 16px; }
  .post-meta { color: var(--text-muted); font-size: 0.8rem; font-weight: 500; letter-spacing: 0.04em; text-transform: uppercase; }
  .post-content { max-width: 680px; margin: 0 auto; }
  .post-content :global(h2) { font-size: 1.5rem; font-weight: 700; margin: 40px 0 16px; }
  .post-content :global(p) { color: var(--text-secondary); line-height: 1.8; margin-bottom: 20px; font-size: 1.05rem; }
  .post-content :global(strong) { color: var(--text-primary); font-weight: 700; }
  .post-content :global(ol), .post-content :global(ul) { color: var(--text-secondary); padding-left: 24px; margin-bottom: 20px; line-height: 1.8; }
  .post-content :global(li) { margin-bottom: 8px; }
</style>
